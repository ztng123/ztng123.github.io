---
layout: post
title: ğŸ—“ï¸ êµ¬ê¸€ ìº˜ë¦°ë” API (1) ì´ë²¤íŠ¸ ë§Œë“¤ê¸°
tags: [google]
---

Google Calendar APIëŠ” ëª…ì‹œì  HTTP í˜¸ì¶œì„ í†µí•´ ë˜ëŠ” Google í´ë¼ì´ì–¸íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆëŠ” RESTful APIë¡œ ì´ë¥¼ ì‚¬ìš©í•´ ì´ë²¤íŠ¸ ë§Œë“¤ê¸°

---

## ğŸ”— API ì‚¬ìš© ì¤€ë¹„

&nbsp;

#### OAuth 2.0 í´ë¼ì´ì–¸íŠ¸ ID ìƒì„±

&nbsp;

1. [ì‚¬ìš©ì ì¸ì¦ ì •ë³´](https://console.cloud.google.com/apis/credentials?hl=ko&_ga=2.108419079.467097148.1690425194-107950802.1690422893) ì— ë“¤ì–´ê°€ê¸°

&nbsp;

&nbsp;

2. OAuth í´ë¼ì´ì–¸íŠ¸ ID ìƒì„±

&nbsp;

<img width="437" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-07-27 á„‹á…©á„’á…® 1 16 20" src="https://github.com/spring-projects/spring-security-samples/assets/53010592/bc208424-9861-4325-9294-dd266d07609e">

&nbsp;

&nbsp;

3. ì…ë ¥

&nbsp;

<img width="536" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-07 á„‹á…©á„’á…® 4 11 13" src="https://github.com/googleworkspace/java-samples/assets/53010592/4150aaef-1ed8-48e7-b204-9b131ac490a2">

- ë¦¬ë‹¤ì´ë ‰íŠ¸ URI ì„¤ì •

  ```
  http://localhost:8888/Callback
  ```

&nbsp;

&nbsp;

4. API ë¼ì´ë¸ŒëŸ¬ë¦¬

&nbsp;

   <img width="1319" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-07 á„‹á…©á„’á…® 4 14 03" src="https://github.com/googleworkspace/java-samples/assets/53010592/2bbcf5b2-b9ed-4ed4-8545-4fcdebb5e968">

&nbsp;

Google Calendar ê²€ìƒ‰í•´ì„œ ì‚¬ìš©í•˜ê¸°

&nbsp;

&nbsp;

5. OAuth ë™ì˜ í™”ë©´

&nbsp;

   <img width="1073" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-07 á„‹á…©á„’á…® 4 17 00" src="https://github.com/googleworkspace/java-samples/assets/53010592/59e4f70e-2e0b-48f9-bc48-9729cc8b6d00">

&nbsp;

ì•±ì— í•„ìš”í•œ ìŠ¹ì¸ ë²”ìœ„ ì¶”ê°€í•˜ê¸°

&nbsp;

&nbsp;

## ğŸ“ ì¸ì¦ê³¼ ì„œë¹„ìŠ¤ ìƒì„±

&nbsp;

&nbsp;

#### OAuth í´ë¼ì´ì–¸íŠ¸ ë‹¤ìš´ë¡œë“œ

&nbsp;

<img width="1046" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-07 á„‹á…©á„’á…® 4 27 48" src="https://github.com/googleworkspace/java-samples/assets/53010592/665f2956-a4bb-41e3-a309-9b467907a63c">

&nbsp;

json íŒŒì¼ ë‹¤ìš´ë¡œë“œ ë°›ì•„ credentials.jsonìœ¼ë¡œ íŒŒì¼ì´ë¦„ ë³€ê²½ í›„ /src/main/resources í´ë”ë¡œ ì˜®ê¸°ê¸°

&nbsp;

&nbsp;

#### build.gradle

&nbsp;

```gradle
plugins {
    id 'java'
    id 'org.springframework.boot' version '3.1.2'
    id 'io.spring.dependency-management' version '1.1.2'
}

group = 'com.example'
version = '0.0.1-SNAPSHOT'
apply plugin: 'application'

mainClassName = 'CalendarQuickstart'
sourceCompatibility = 17
targetCompatibility = 17
version = '1.0'

java {
    sourceCompatibility = '17'
}

repositories {
    mavenCentral()
}

dependencies {
    implementation 'org.springframework.boot:spring-boot-starter'
    testImplementation 'org.springframework.boot:spring-boot-starter-test'
    implementation 'com.google.api-client:google-api-client:2.0.0'
    implementation 'com.google.oauth-client:google-oauth-client-jetty:1.34.1'
    implementation 'com.google.apis:google-api-services-calendar:v3-rev20220715-2.0.0'
}

tasks.named('test') {
    useJUnitPlatform()
}
```

&nbsp;

&nbsp;

#### CalendarQuickstart.java

&nbsp;

```java
@SpringBootApplication
public class CalendarQuickstart {

  private static final String APPLICATION_NAME = "Google Calendar API Java Quickstart";

  private static final JsonFactory JSON_FACTORY = GsonFactory.getDefaultInstance();

  private static final String TOKENS_DIRECTORY_PATH = "tokens"; //í† í° ì €ì¥ ê²½ë¡œ

  private static final List<String> SCOPES =
      Collections.singletonList(CalendarScopes.CALENDAR_READONLY);
  private static final String CREDENTIALS_FILE_PATH = "/credentials.json";

  private static Credential getCredentials(final NetHttpTransport HTTP_TRANSPORT)
      throws IOException {//ì¸ì¦ì— í•„ìš”í•œ ê°ì²´ ìƒì„±,ë°˜í™˜

    InputStream in = CalendarQuickstart.class.getResourceAsStream(CREDENTIALS_FILE_PATH);
    if (in == null) {
      throw new FileNotFoundException("Resource not found: " + CREDENTIALS_FILE_PATH);
    }
    GoogleClientSecrets clientSecrets =
        GoogleClientSecrets.load(JSON_FACTORY, new InputStreamReader(in));


    GoogleAuthorizationCodeFlow flow = new GoogleAuthorizationCodeFlow.Builder( // ì¸ì¦ íë¦„ ë§Œë“¤ê¸°
        HTTP_TRANSPORT, JSON_FACTORY, clientSecrets, SCOPES)
        .setDataStoreFactory(new FileDataStoreFactory(new java.io.File(TOKENS_DIRECTORY_PATH)))
        .setAccessType("offline")
        .build();
    LocalServerReceiver receiver = new LocalServerReceiver.Builder().setPort(8888).build();
    Credential credential = new AuthorizationCodeInstalledApp(flow, receiver).authorize("user"); //ì‚¬ìš©ì ì¸ì¦,í† í° ì €ì¥
    return credential;
  }

  public static void main(String... args) throws IOException, GeneralSecurityException {
    final NetHttpTransport HTTP_TRANSPORT = GoogleNetHttpTransport.newTrustedTransport();
    Calendar service =
        new Calendar.Builder(HTTP_TRANSPORT, JSON_FACTORY, getCredentials(HTTP_TRANSPORT))
            .setApplicationName(APPLICATION_NAME)
            .build();

    DateTime now = new DateTime(System.currentTimeMillis());
    Events events = service.events().list("primary")
        .setMaxResults(10)
        .setTimeMin(now)
        .setOrderBy("startTime")
        .setSingleEvents(true)
        .execute();
    List<Event> items = events.getItems(); // ê°€ì ¸ì˜¨ ì´ë²¤íŠ¸ ì €ì¥
    if (items.isEmpty()) {
      System.out.println("No upcoming events found.");
    } else {
      System.out.println("Upcoming events");
      for (Event event : items) {
        DateTime start = event.getStart().getDateTime();
        if (start == null) {
          start = event.getStart().getDate();
        }
        System.out.printf("%s (%s)\n", event.getSummary(), start); //ì´ë²¤íŠ¸ ìš”ì•½ê³¼ ì‹œì‘ì‹œê°„ ì¶œë ¥

      }
    }
    SpringApplication.run(CalendarQuickstart.class, args);
  }
}
```

&nbsp;

&nbsp;

ğŸ“Œ scopes

&nbsp;

```java
private static final List<String> SCOPES =
      Collections.singletonList(CalendarScopes.CALENDAR_READONLY);
```

&nbsp;

ìš”ì²­í•˜ëŠ” ì•¡ì„¸ìŠ¤ ë²”ìœ„ë¡œ ì—¬ê¸°ì„œëŠ” ìº˜ë¦°ë”ì— ëŒ€í•œ ì½ê¸° ì „ìš© ì•¡ì„¸ìŠ¤ë¥¼ ìš”ì²­

&nbsp;

&nbsp;

ğŸ“Œ ì¸ì¦ ì„¤ì •

&nbsp;

```java
private static Credential getCredentials(final NetHttpTransport HTTP_TRANSPORT)
      throws IOException {//ì¸ì¦ì— í•„ìš”í•œ ê°ì²´ ìƒì„±,ë°˜í™˜

    InputStream in = CalendarQuickstart.class.getResourceAsStream(CREDENTIALS_FILE_PATH); //credentials.json ë¡œë“œ
    if (in == null) {
      throw new FileNotFoundException("Resource not found: " + CREDENTIALS_FILE_PATH);
    }
    GoogleClientSecrets clientSecrets =
        GoogleClientSecrets.load(JSON_FACTORY, new InputStreamReader(in));


    GoogleAuthorizationCodeFlow flow = new GoogleAuthorizationCodeFlow.Builder( // ì¸ì¦ íë¦„ ë§Œë“¤ê¸°
        HTTP_TRANSPORT, JSON_FACTORY, clientSecrets, SCOPES)
        .setDataStoreFactory(new FileDataStoreFactory(new java.io.File(TOKENS_DIRECTORY_PATH)))
        .setAccessType("offline")
        .build();
    LocalServerReceiver receiver = new LocalServerReceiver.Builder().setPort(8888).build();
    Credential credential = new AuthorizationCodeInstalledApp(flow, receiver).authorize("user"); //ì‚¬ìš©ì ì¸ì¦,í† í° ì €ì¥
    return credential;
  }
```

&nbsp;

> `GoogleAuthorizationCodeFlow`: OAuth 2.0 ì¸ì¦ íë¦„ì„ ì„¤ì •í•˜ê³  ê´€ë¦¬(í´ë¼ì´ì–¸íŠ¸ ì •ë³´,ìš”ì²­ ê¶Œí•œ,ë°ì´í„° ì €ì¥ì†Œ,ì•¡ì„¸ìŠ¤ ìœ í˜•)

&nbsp;

> `LocalServerReciever`: OAuth 2.0 ì¸ì¦ ì„œë²„ë¡œë¶€í„° ì¸ì¦ ì½”ë“œë¥¼ ìˆ˜ì‹ 

&nbsp;

> `setDataStoreFactory()`: ì¸ì¦ í† í°ê³¼ ê´€ë ¨ëœ ë°ì´í„° ì €ì¥í•  ìœ„ì¹˜ ì„¤ì •

&nbsp;

> `setAccessType("offline")`: ì‚¬ìš©ìê°€ ë¡œê·¸ì•„ì›ƒ ìƒíƒœì—ì„œë„ ì•¡ì„¸ìŠ¤ í† í°ì„ ì œê³µ, ë¡œê·¸ì¸í•˜ì§€ ì•Šì€ ìƒíƒœì—ì„œë„ API í˜¸ì¶œ ê°€ëŠ¥

&nbsp;

> `AuthorizationCodeInstalledApp(flow,receiver).authorize()`: OAuth 2.0 ì¸ì¦ íë¦„ì„ ì²˜ë¦¬í•˜ê³  authorize ë©”ì„œë“œë¡œ ì‚¬ìš©ì ì¸ì¦ ìˆ˜í–‰í•˜ê³  Credential ë°˜í™˜

&nbsp;

> `Credential`: Google API í˜¸ì¶œí•  ë•Œ í•„ìš”í•œ ì¸ì¦ì •ë³´(ì•¡ì„¸ìŠ¤ í† í° ë“±)ì„ í¬í•¨í•˜ë©° í›„ì† API í˜¸ì¶œì‹œ ì´ë¥¼ ì´ìš©í•´ ì¸ì¦

&nbsp;

&nbsp;

ğŸ“Œ ì´ë²¤íŠ¸ ê°€ì ¸ì˜¤ê¸°

&nbsp;

```java
Events events = service.events().list("primary")
        .setMaxResults(10)
        .setTimeMin(now)
        .setOrderBy("startTime")
        .setSingleEvents(true)
        .execute();
```

&nbsp;

> `setMaxResults(n)` : ìµœëŒ€ nê°œì˜ ì´ë²¤íŠ¸ ê°€ì ¸ì˜¤ê¸°

&nbsp;

> `setTimeMin(datetime)` : datetime ì´í›„ì˜ ì´ë²¤íŠ¸ë§Œ ê°€ì ¸ì˜¤ê¸°

&nbsp;

> `setOrderBy("startTime")` : ì´ë²¤íŠ¸ë¥¼ ì‹œì‘ ì‹œê°„ ìˆœìœ¼ë¡œ ì •ë ¬

&nbsp;

> `setSingleEvents(true)` : ë°˜ë³µë˜ëŠ” ì´ë²¤íŠ¸ë¥¼ ê°œë³„ ì´ë²¤íŠ¸ë¡œ í‘œì‹œ

&nbsp;

> `excute()` : ìœ„ì˜ ì„¤ì •ì— ë”°ë¼ ì´ë²¤íŠ¸ ê°€ì ¸ì˜¤ê¸°

&nbsp;

&nbsp;

## ğŸª„ ì´ë²¤íŠ¸ ìƒì„±

&nbsp;

#### ìº˜ë¦°ë”

&nbsp;

ìº˜ë¦°ë”ëŠ” ì´ë²¤íŠ¸ë“¤ì„ ëª¨ì•„ë†“ì€ ê²ƒìœ¼ë¡œ ìš”ì•½, ê¸°ë³¸ ì‹œê°„ëŒ€, ìœ„ì¹˜ ë“±ì„ í¬í•¨í•˜ë©° ê° ìº˜ë¦°ë”ëŠ” ì´ë©”ì¼ ì£¼ì†Œì¸ IDë¡œ ì‹ë³„

&nbsp;

ğŸ“Œ ìº˜ë¦°ë” ìœ í˜•

&nbsp;

- ê¸°ë³¸ ìº˜ë¦°ë”: ë‹¨ì¼ ì‚¬ìš©ì ê³„ì •ê³¼ ì—°ê²°ëœ ìº˜ë¦°ë”ë¡œ í•´ë‹¹ IDëŠ” ì¼ë°˜ì ìœ¼ë¡œ ì‚¬ìš©ìì˜ ê¸°ë³¸ ì´ë©”ì¼ ì£¼ì†Œì™€ ì¼ì¹˜í•˜ë©° ì‚­ì œ ë¶ˆê°€ëŠ¥

&nbsp;

- ë³´ì¡° ìº˜ë¦°ë” : ê¸°ë³¸ ìº˜ë¦°ë” ì™¸ì— ì‚¬ìš©ìê°€ ì¶”ê°€ë¡œ ìƒì„±í•˜ê±°ë‚˜ êµ¬ë…í•˜ëŠ” ìº˜ë¦°ë”

&nbsp;

&nbsp;

ğŸ“Œ Calendar

&nbsp;

- ìº˜ë¦°ë”ëŠ” ì‹œê°„ì— ë”°ë¥¸ ì¼ì •ê³¼ ì´ë²¤íŠ¸ì˜ ëª¨ìŒ

&nbsp;

- í•œ ì‚¬ìš©ìê°€ ì†Œìœ í•˜ê±°ë‚˜ ê³µìœ ë°›ì€ ì—¬ëŸ¬ ê°œì˜ ìº˜ë¦°ë” ê°€ì§ˆ ìˆ˜ ìˆìŒ

&nbsp;

&nbsp;

ğŸ“Œ CalendarList

&nbsp;

- ì‚¬ìš©ìê°€ ì ‘ê·¼í•˜ê±°ë‚˜ êµ¬ë…í•˜ê³  ìˆëŠ” ëª¨ë“  ìº˜ë¦°ë”ì˜ ëª©ë¡

&nbsp;

- ì›¹ UI ì™¼ìª½ íŒ¨ë„ì—ì„œ ë³¼ ìˆ˜ ìˆëŠ” ìº˜ë¦°ë” ëª©ë¡

&nbsp;

- ìƒ‰ ì§€ì • ë“± ì‚¬ìš©ìë³„ë¡œ ê³ ìœ í•œ ìº˜ë¦°ë” ì„¤ì •

&nbsp;

<img width="222" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-08 á„‹á…©á„’á…® 8 19 34" src="https://github.com/ztng123/calendar/assets/53010592/7eb503ec-7e2f-4174-9ca6-a1cc7f95bcfb">

&nbsp;

"ìƒì¼","Tasks"ì™€ ê°™ì€ Calendarë“¤ì„ ë‚˜ì—´í•œ ëª©ë¡ì¸ "ë‚´ ìº˜ë¦°ë”","ë‹¤ë¥¸ ìº˜ë¦°ë”"ê°€ CalendarList

&nbsp;

&nbsp;

ğŸ“Œ Calendar VS CalendarList

&nbsp;

|     ì‘ì—…     |              Calendar               |                      CalendarList                      |
| :----------: | :---------------------------------: | :----------------------------------------------------: |
|    insert    |         ìƒˆ ë³´ì¡° ìº˜ë¦°ë” ìƒì„±         |            íŠ¹ì • ìº˜ë¦°ë”ë¥¼ ì‚¬ìš©ì ëª©ë¡ì— ì‚½ì…            |
|    delete    |         ë³´ì¡° ìº˜ë¦°ë”ë¥¼ ì‚­ì œ          |              ì‚¬ìš©ì ëª©ë¡ì—ì„œ ìº˜ë¦°ë” ì‚­ì œ               |
|     get      | ìº˜ë¦°ë” ë©”íƒ€ë°ì´í„°(ì œëª©,ì‹œê°„ëŒ€) ê²€ìƒ‰ | íŠ¹ì • ìº˜ë¦°ë”ì— ê´€í•œ ì •ë³´(ë©”íƒ€ë°ì´í„°,ìƒ‰ìƒ,ì•Œë¦¼ì„¤ì •) ê²€ìƒ‰ |
| patch/update |       ìº˜ë¦°ë” ë©”íƒ€ë°ì´í„° ìˆ˜ì •        |               ì‚¬ìš©ìë³„ ìº˜ë¦°ë” ì†ì„± ìˆ˜ì •                |

&nbsp;

ë‹¤ë¥¸ ì‚¬ìš©ìì˜ ìº˜ë¦°ë”ë¥¼ ê³µìœ  ë°›ê±°ë‚˜ êµ¬ë…í•  ë•Œ, ê·¸ ìº˜ë¦°ë”ë¥¼ ìº˜ë¦°ë” ëª©ë¡ì— ì¶”ê°€í•˜ë ¤ë©´ `CalendarList` insert ì‚¬ìš©

&nbsp;

&nbsp;

#### ì´ë²¤íŠ¸

&nbsp;

ì´ë²¤íŠ¸ëŠ” íŠ¹ì • ë‚ ì§œ ë˜ëŠ” ì‹œê°„ ë²”ìœ„ì™€ ê´€ë ¨ëœ ê°ì²´ë¡œ ê³ ìœ  IDë¡œ ì‹ë³„

&nbsp;

ğŸ“Œ ì´ë²¤íŠ¸ ìœ í˜•

&nbsp;

- ë‹¨ì¼ ì´ë²¤íŠ¸: ê³ ìœ í•œ ë°œìƒ

&nbsp;

- ë°˜ë³µ ì´ë²¤íŠ¸: ì—¬ëŸ¬ë²ˆ ì¼ì¹˜í•˜ëŠ” í•­ëª©ì„ ì •ì˜

&nbsp;

- ì‹œê°„ ì§€ì • ì´ë²¤íŠ¸: ë‘ íŠ¹ì • ì‹œì  ì‚¬ì—ì´ ë°œìƒí•´ start.dateTimeê³¼ end.dateTime í•„ë“œ ì‚¬ìš©í•´ ë°œìƒ ì‹œì  ì§€ì •

&nbsp;

- ì¢…ì¼ ì´ë²¤íŠ¸: ì¢…ì¼ ë˜ëŠ” ì—°ì†ëœ ë©°ì¹ ì— ê±¸ì³ ì§„í–‰í•´ start.dateì™€ end.dateí•„ë“œë¥¼ ì‚¬ìš©í•´ ë°œìƒ ì‹œì  ì§€ì •
  ì´ë²¤íŠ¸ì˜ ì‹œì‘ê³¼ ì¢…ë£Œì‹œê°„ì„ ëª¨ë‘ ì§€ì •í•˜ê±°ë‚˜, ì¢…ì¼ì´ì–´ì•¼í•´ ë‘ ê°€ì§€ë¥¼ ë™ì‹œì— ì‚¬ìš© ë¶ˆê°€ëŠ¥

&nbsp;

&nbsp;

ğŸ“Œ ì£¼ìµœì

- í•´ë‹¹ ìº˜ë¦°ë” ì´ë²¤íŠ¸ë¥¼ ìƒì„±í•œ ì‚¬ëŒ
- ì´ë²¤íŠ¸ì˜ ë³€ê²½ ê¶Œí•œì´ ìˆìŒ

&nbsp;

&nbsp;

ğŸ“Œ ì°¸ì„ì

- í•´ë‹¹ ì´ë²¤íŠ¸ì— ì´ˆëŒ€ë°›ì€ ì‚¬ëŒ
- ì´ë²¤íŠ¸ì˜ ì°¸ì„ ìƒíƒœ ì •ë³´ë¥¼ ê°€ì§
- attendees í•„ë“œë¥¼ í†µí•´ ì°¸ì„ì ì •ë³´ ì œê³µ
  ìº˜ë¦°ë” ì¼ì •ì„ ë§Œë“¤ê³  ì‚¬ìš©ìì˜ ìº˜ë¦°ë”ì— ì¶”ê°€í•˜ëŠ” ë°©ë²•

&nbsp;

&nbsp;

#### ì¼ì • ì¶”ê°€

&nbsp;

ğŸ“Œ scopes

&nbsp;

```java
private static final List<String> SCOPES =
      Collections.singletonList(CalendarScopes.CALENDAR);
```

&nbsp;

OAuth ë²”ìœ„ë¥¼ ì‚¬ìš©ìì˜ ìº˜ë¦°ë”ì— ëŒ€í•œ ìˆ˜ì • ì•¡ì„¸ìŠ¤ ê¶Œí•œì„ ë¶€ì—¬í•˜ê²Œ ë³€ê²½

&nbsp;

&nbsp;

âš ï¸ 403 PERMISSION_DENIED

&nbsp;

```
"code": 403,
  "details": [
    {
      "@type": "type.googleapis.com/google.rpc.ErrorInfo",
      "reason": "ACCESS_TOKEN_SCOPE_INSUFFICIENT"
    }
  ],
  "errors": [
    {
      "domain": "global",
      "message": "Insufficient Permission",
      "reason": "insufficientPermissions"
    }
  ],
  "message": "Request had insufficient authentication scopes.",
  "status": "PERMISSION_DENIED"
```

&nbsp;

ê¶Œí•œì´ ì œëŒ€ë¡œ ë³€ê²½ë˜ì§€ ì•Šì•˜ëŠ”ë° ì´ëŠ” ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ì•¡ì„¸ìŠ¤ í† í°ì— ì˜í•œ ë¬¸ì œ

&nbsp;

&nbsp;

ğŸ“Œ í† í° í´ë” ì‚­ì œ

&nbsp;

ìœ„ì— ì§€ì •í•œ í† í° ì €ì¥ ê²½ë¡œ "tokens" í´ë” ì‚­ì œí•˜ê³  ë‹¤ì‹œ ì‹¤í–‰í•˜ë©´ ë³€ê²½ëœ ê¶Œí•œì„ í¬í•¨í•´ ìƒˆë¡œìš´ ì•¡ì„¸ìŠ¤ í† í° ë°œê¸‰

&nbsp;

&nbsp;

ğŸ“Œ ê²°ê³¼

&nbsp;

<img width="488" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-07 á„‹á…©á„’á…® 12 02 09" src="https://github.com/googleworkspace/java-samples/assets/53010592/882102d8-aa25-4b6a-9759-62fe39407337">

&nbsp;

&nbsp;

ğŸ“Œ main()

&nbsp;

```java

public static void main(String... args) throws IOException, GeneralSecurityException {
    // . . .

    Event event = new Event()
        .setSummary("Google I/O 2023")
        .setLocation("800 Howard St., San Francisco, CA 94103")
        .setDescription("A chance to hear more about Google's developer products.");

    DateTime startDateTime = new DateTime("2023-08-07T09:00:00-07:00"); //ì‹œì‘ì‹œê°„
    EventDateTime start = new EventDateTime()
        .setDateTime(startDateTime)
        .setTimeZone("America/Los_Angeles");
    event.setStart(start);

    DateTime endDateTime = new DateTime("2023-08-07T17:00:00-07:00"); //ì¢…ë£Œì‹œê°„
    EventDateTime end = new EventDateTime()
        .setDateTime(endDateTime)
        .setTimeZone("America/Los_Angeles");
    event.setEnd(end);

    String[] recurrence = new String[] {"RRULE:FREQ=DAILY;COUNT=2"}; //ì´ë²¤íŠ¸ ë°˜ë³µ
    event.setRecurrence(Arrays.asList(recurrence));

    EventAttendee[] attendees = new EventAttendee[] { // ì°¸ì„ì ì¶”ê°€
        new EventAttendee().setEmail("lpage@example.com"),
        new EventAttendee().setEmail("sbrin@example.com"),
    };
    event.setAttendees(Arrays.asList(attendees));

    EventReminder[] reminderOverrides = new EventReminder[] { // ì•Œë¦¼ ì„¤ì •
        new EventReminder().setMethod("email").setMinutes(24 * 60), //24ì‹œê°„ ì „
        new EventReminder().setMethod("popup").setMinutes(10), //10ë¶„ ì „
    };
    Event.Reminders reminders = new Event.Reminders()
        .setUseDefault(false)
        .setOverrides(Arrays.asList(reminderOverrides));
    event.setReminders(reminders);

    String calendarId = "primary"; //ì´ë²¤íŠ¸ë¥¼ ì‚¬ìš©ìì˜ ê¸°ë³¸ ìº˜ë¦°ë”ì— ì¶”ê°€
    event = service.events().insert(calendarId, event).execute();
    System.out.printf("Event created: %s\n", event.getHtmlLink());
}
```

&nbsp;

> `DateTime("YYYY-MM-DDTHH:MM:SS-ì‹œê°„ëŒ€")`: ë‚ ì§œ+T(ë‚ ì§œì™€ ì‹œê°„ ì‚¬ì´ êµ¬ë¶„í•˜ëŠ” ë¬¸ì)+ì‹œê°„+ì‹œê°„ëŒ€

&nbsp;

> `String[] recurrence = new String[] {"RRULE:FREQ=DAILY;COUNT=2"}` : ì´ë²¤íŠ¸ì˜ ë°˜ë³µ ì„¤ì •í•˜ëŠ” ê²ƒìœ¼ë¡œ ì¼ì¼(DAILY) ì´ 2ë²ˆ(COUNT) ë°˜ë³µ

&nbsp;

> `calendarId` : ìº˜ë¦°ë”ë¥¼ ì‹ë³„í•˜ëŠ”ë° ì‚¬ìš©ë˜ëŠ” ê³ ìœ í•œ ì‹ë³„ì

&nbsp;

> "primary"ëŠ” ì‚¬ìš©ìì˜ ê¸°ë³¸ ìº˜ë¦°ë”ì´ê³  ê° ìº˜ë¦°ë”ëŠ” ê³ ìœ í•œ calendarIdë¥¼ ê°–ê³  ìˆìŒ

&nbsp;

&nbsp;

ğŸ“Œ calendarId ì°¾ê¸°

&nbsp;

```java
CalendarList calendarList = service.calendarList().list().execute();
for (CalendarListEntry calendarListEntry : calendarList.getItems()) {
    System.out.println("Calendar ID: " + calendarListEntry.getId());
}
```

&nbsp;

ê¸°ë³¸ìº˜ë¦°ë”ê°€ ì•„ë‹Œ ë‹¤ë¥¸ ìº˜ë¦°ë”ì˜ idê°€ ê¶ê¸ˆí•  ë•Œ calenderListì—ì„œ ì°¾ê¸°

&nbsp;

&nbsp;

ğŸ“Œ ê²°ê³¼

&nbsp;

<img width="1858" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-07 á„‹á…©á„’á…® 2 28 39" src="https://github.com/googleworkspace/java-samples/assets/53010592/b8fc6ea9-6c0d-42ff-97a7-1125fc58e0de">

&nbsp;

&nbsp;

#### ë°˜ë³µ ê·œì¹™

&nbsp;

RRULE ì†ì„±ìœ¼ë¡œ ì´ë²¤íŠ¸ë¥¼ ë°˜ë³µí•˜ëŠ” ì¼ë°˜ ê·œì¹™ ì •ì˜

&nbsp;

> `FREQ` : ì´ë²¤íŠ¸ë¥¼ ë°˜ë³µí•´ì•¼ í•˜ëŠ” ë¹ˆë„ (DAILY, WEEKLY . . .), í•„ìˆ˜ë¡œ ì…ë ¥

&nbsp;

> `INTERVAL` : FREQì™€ í•¨ê»˜ ì´ë²¤íŠ¸ê°€ ë°˜ë³µë˜ì–´ì•¼ í•˜ëŠ” ë¹ˆë„ ì§€ì • (FREQ = DAILY;INTERVAL=2 ë¼ë©´ 2ì¼ì— í•œ ë²ˆ)

&nbsp;

> `COUNT` : ì´ ì¼ì •ì„ ë°˜ë³µí•´ì•¼ í•˜ëŠ” íšŸìˆ˜

&nbsp;

> `UNTIL` : ì´ë²¤íŠ¸ë¥¼ ë°˜ë³µí•´ì•¼ í•˜ëŠ” ë‚ ì§œ ë˜ëŠ” ë‚ ì§œ-ì‹œê°„

&nbsp;

> `BYDAY` : ì´ë²¤íŠ¸ë¥¼ ë°˜ë³µí•  ìš”ì¼(SU,MO,TU . . .)

&nbsp;

> `BYMONTH`: ì´ë²¤íŠ¸ë¥¼ ë°˜ë³µí•  ë‹¬

&nbsp;

> `EXDATE` : ì´ë²¤íŠ¸ê°€ ë°œìƒí•˜ì§€ ì•Šì•„ì•¼í•˜ëŠ” ë‚ ì§œë‚˜ ë‚ ì§œ-ì‹œê°„ ì§€ì •

&nbsp;

&nbsp;

#### Drive ì²¨ë¶€íŒŒì¼ ì¶”ê°€

&nbsp;

ğŸ“Œ dependency ì¶”ê°€

&nbsp;

```gradle
implementation 'com.google.apis:google-api-services-drive:v3-rev20220815-2.0.0'
```

&nbsp;

&nbsp;

ğŸ“Œ ì—°ê²° ì¶”ê°€

&nbsp;

```java
public static void addAttachment(Calendar calendarService, Drive driveService, String calendarId,
                                    String eventId, String fileUrl)throws IOException {
    String fileId = extractFileIdFromUrl(fileUrl);
    File file = driveService.files().get(fileId).execute();
    Event event = calendarService.events().get(calendarId, eventId).execute();

    List<EventAttachment> attachments = event.getAttachments();
    if (attachments == null) {
    attachments = new ArrayList<EventAttachment>();
    }
    attachments.add(new EventAttachment() //ì²¨ë¶€íŒŒì¼ ì¶”ê°€
    .setFileUrl("https://drive.google.com/file/d/" + fileId + "/view?usp=drive_link")
    .setMimeType(file.getMimeType())
    .setTitle(file.getName()));

    Event changes = new Event()
    .setAttachments(attachments); //ì²¨ë¶€íŒŒì¼ ëª©ë¡ ì“°ê¸°
    calendarService.events().patch(calendarId, eventId, changes) //ë³€ê²½ì‚¬í•­ ì ìš©
    .setSupportsAttachments(true) //ì²¨ë¶€íŒŒì¼ ê¸°ëŠ¥ í™œì„±í™”
    .execute();
                                    }
public static void main(String... args) throws IOException, GeneralSecurityException {
    // . . .

    String fileUrl = "ì¶”ê°€í•˜ê³  ì‹¶ì€ ë“œë¼ì´ë¸Œ íŒŒì¼ URL";
    addAttachment(calendarService, driveService, calendarId, event.getId(), fileUrl);
}
```

&nbsp;

êµ¬ê¸€ë“œë¼ì´ë¸Œ íŒŒì¼ url("https://drive.google.com/file/d/" + fileId + "/view?usp=drive_link")ì—ì„œ fileIdê°€ í•„ìš”í•´ extractFileIdFromUrl(fileUrl)ë¡œ ë¶„ë¦¬

&nbsp;

> `fileId` : ê° íŒŒì¼ì˜ ê³ ìœ í•œ IDë¡œ íŒŒì¼ ì´ë¦„ì´ ë³€ê²½ë˜ë”ë¼ë„ ìœ ì§€ë¼ íŒŒì¼ì„ ì°¾ëŠ”ë°ì— ì‚¬ìš©

&nbsp;

> `driveService.files.get(fileId)` : fileIdë¡œ íŒŒì¼ì˜ ì •ë³´(ì´ë¦„,MIME ìœ í˜•) ê°€ì ¸ì˜¤ê¸°

&nbsp;

> `calendarService.events().get(calendarId, eventId)` : ìº˜ë¦°ë”IDì™€ ì´ë²¤íŠ¸ Iì— í•´ë‹¹í•˜ëŠ” ì´ë²¤íŠ¸ì˜ ì •ë³´ ìš”ì²­

&nbsp;

> `event.getAttachments()` : í˜„ì¬ ì´ë²¤íŠ¸ì— ì²¨ë¶€ëœ íŒŒì¼ë“¤ì˜ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°

&nbsp;

> `calendarService.events().patch(calendarId,eventId,changes)` : Google Calendar ì´ë²¤íŠ¸ ìˆ˜ì •í•˜ëŠ”ë° ì‚¬ìš©ë˜ëŠ”ë° ì œê³µëœ í•„ë“œë§Œ ì—…ë°ì´íŠ¸
> changesëŠ” ë³€ê²½í•˜ë ¤ëŠ” ì´ë²¤íŠ¸ì˜ ì†ì„±ì„ í¬í•¨í•˜ëŠ” Event ê°ì²´ë¡œ ë³€ê²½í•˜ë ¤ëŠ” í•„ë“œë§Œ í¬í•¨

&nbsp;

&nbsp;

ğŸ“ŒfileId ì¶”ì¶œ

&nbsp;

```java
private static String extractFileIdFromUrl(String url) {
    String fileId = null;
    try {
        URL fileUrl = new URL(url);
        String path = fileUrl.getPath();
        Pattern pattern = Pattern.compile("file/d/(.*?)/");
        Matcher matcher = pattern.matcher(path);
        if (matcher.find()) {
            fileId = matcher.group(1);
        }
    } catch (MalformedURLException e) {
    e.printStackTrace();
    }
    return fileId;
}
```

&nbsp;

&nbsp;

ğŸ“Œ ê²°ê³¼

&nbsp;

<img width="441" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-07 á„‹á…©á„’á…® 3 25 08" src="https://github.com/googleworkspace/java-samples/assets/53010592/aa75a2ba-6b37-44a8-9216-307799c96bcf">

&nbsp;

&nbsp;

#### í™”ìƒíšŒì˜ ì¶”ê°€

&nbsp;

ğŸ“Œ main()

```java
public static void main(String... args) throws IOException, GeneralSecurityException {
    // . . .
    ConferenceSolutionKey conferenceSKey = new ConferenceSolutionKey();
    conferenceSKey.setType("hangoutsMeet"); //GoogleMeet
    CreateConferenceRequest createConferenceReq = new CreateConferenceRequest(); //íšŒì˜ ìƒì„±
    createConferenceReq.setRequestId(UUID.randomUUID().toString());
    createConferenceReq.setConferenceSolutionKey(conferenceSKey);
    ConferenceData conferenceData = new ConferenceData();
    conferenceData.setCreateRequest(createConferenceReq);
    event.setConferenceData(conferenceData);

    //event = calendarService.events().insert(calendarId, event).execute();
    event = calendarService.events().insert(calendarId, event).setConferenceDataVersion(1).execute(); //íšŒì˜ ìƒì„±í•˜ê³  ì´ë²¤íŠ¸ì— ì¶”ê°€
}
```

&nbsp;

> `.setRequestId(UUID.randomUUID().toString())` : ìš”ì²­ ID ì„¤ì •í•˜ëŠ”ë°, ì¤‘ë³µë˜ì§€ ì•ŠëŠ” ê³ ìœ í•œ ê°’ ì„¤ì •í•˜ê¸° ìœ„í•´ UUID ì‚¬ìš©

&nbsp;

> `.setConferenceDataVersion(1)` : Google Calendar APIì— ì´ë²¤íŠ¸ê°€ íšŒì˜ ë°ì´í„°ë¥¼ í¬í•¨í•˜ê³  ìˆìŒì„ ì•Œë¦¼
> ì´ë¡œ ì¸í•´ APIëŠ” íšŒì˜ë¥¼ ìƒì„±í•˜ê³ , íšŒì˜ ì •ë³´ë¥¼ ì´ë²¤íŠ¸ì— ì¶”ê°€í•˜ë©°, ì´ë²¤íŠ¸ ì°¸ê°€ìì—ê²Œ íšŒì˜ì— ëŒ€í•œ ì •ë³´ë¥¼ ì œê³µ

&nbsp;

> `.setCreateRequest(createConferenceReq)` : íšŒì˜ ìƒì„± ìš”ì²­ ì„¤ì •

&nbsp;

&nbsp;

ğŸ“Œ ê²°ê³¼

&nbsp;

<img width="432" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-07 á„‹á…©á„’á…® 3 34 30" src="https://github.com/googleworkspace/java-samples/assets/53010592/97c33076-1367-425d-9418-7f328093537e">

&nbsp;

&nbsp;

---

ì¶œì²˜:[GoogleWorkspace](https://developers.google.com/calendar/api/guides/overview?hl=ko)
