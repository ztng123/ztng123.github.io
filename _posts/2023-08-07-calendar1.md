---
layout: post
title: ğŸ—“ï¸ êµ¬ê¸€ ìº˜ë¦°ë” API (1) ì´ë²¤íŠ¸ ë§Œë“¤ê¸°
tags: [google]
---

Google Calendar APIëŠ” ëª…ì‹œì  HTTP í˜¸ì¶œì„ í†µí•´ ë˜ëŠ” Google í´ë¼ì´ì–¸íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆëŠ” RESTful APIë¡œ ì´ë¥¼ ì‚¬ìš©í•´ ì´ë²¤íŠ¸ ë§Œë“¤ê¸°

---

## ğŸ”— API ì‚¬ìš© ì¤€ë¹„

&nbsp;

#### OAuth 2.0 í´ë¼ì´ì–¸íŠ¸ ID ìƒì„±


&nbsp;

1. [ì‚¬ìš©ì ì¸ì¦ ì •ë³´](https://console.cloud.google.com/apis/credentials?hl=ko&_ga=2.108419079.467097148.1690425194-107950802.1690422893) ì— ë“¤ì–´ê°€ê¸°

&nbsp;

&nbsp;

2. OAuth í´ë¼ì´ì–¸íŠ¸ ID ìƒì„±

&nbsp;

<img width="437" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-07-27 á„‹á…©á„’á…® 1 16 20" src="https://github.com/spring-projects/spring-security-samples/assets/53010592/bc208424-9861-4325-9294-dd266d07609e">

&nbsp;

&nbsp;

3. ì…ë ¥

&nbsp;

<img width="536" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-07 á„‹á…©á„’á…® 4 11 13" src="https://github.com/googleworkspace/java-samples/assets/53010592/4150aaef-1ed8-48e7-b204-9b131ac490a2">

- ë¦¬ë‹¤ì´ë ‰íŠ¸ URI ì„¤ì •

  ```
  http://localhost:8888/Callback
  ```

&nbsp;

&nbsp;

4. API ë¼ì´ë¸ŒëŸ¬ë¦¬

&nbsp;

   <img width="1319" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-07 á„‹á…©á„’á…® 4 14 03" src="https://github.com/googleworkspace/java-samples/assets/53010592/2bbcf5b2-b9ed-4ed4-8545-4fcdebb5e968">

&nbsp;

Google Calendar ê²€ìƒ‰í•´ì„œ ì‚¬ìš©í•˜ê¸°

&nbsp;

&nbsp;


5. OAuth ë™ì˜ í™”ë©´

&nbsp;

   <img width="1073" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-07 á„‹á…©á„’á…® 4 17 00" src="https://github.com/googleworkspace/java-samples/assets/53010592/59e4f70e-2e0b-48f9-bc48-9729cc8b6d00">


&nbsp;

ì•±ì— í•„ìš”í•œ ìŠ¹ì¸ ë²”ìœ„ ì¶”ê°€í•˜ê¸°

&nbsp;

&nbsp;


## ğŸ“ ì¸ì¦ê³¼ ì„œë¹„ìŠ¤ ìƒì„±

&nbsp;

&nbsp;

#### OAuth í´ë¼ì´ì–¸íŠ¸ ë‹¤ìš´ë¡œë“œ


&nbsp;

<img width="1046" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-07 á„‹á…©á„’á…® 4 27 48" src="https://github.com/googleworkspace/java-samples/assets/53010592/665f2956-a4bb-41e3-a309-9b467907a63c">


&nbsp;

json íŒŒì¼ ë‹¤ìš´ë¡œë“œ ë°›ì•„ credentials.jsonìœ¼ë¡œ íŒŒì¼ì´ë¦„ ë³€ê²½ í›„ /src/main/resources í´ë”ë¡œ ì˜®ê¸°ê¸°

&nbsp;

&nbsp;


#### build.gradle


&nbsp;

```gradle
plugins {
    id 'java'
    id 'org.springframework.boot' version '3.1.2'
    id 'io.spring.dependency-management' version '1.1.2'
}

group = 'com.example'
version = '0.0.1-SNAPSHOT'
apply plugin: 'application'

mainClassName = 'CalendarQuickstart'
sourceCompatibility = 17
targetCompatibility = 17
version = '1.0'

java {
    sourceCompatibility = '17'
}

repositories {
    mavenCentral()
}

dependencies {
    implementation 'org.springframework.boot:spring-boot-starter'
    testImplementation 'org.springframework.boot:spring-boot-starter-test'
    implementation 'com.google.api-client:google-api-client:2.0.0'
    implementation 'com.google.oauth-client:google-oauth-client-jetty:1.34.1'
    implementation 'com.google.apis:google-api-services-calendar:v3-rev20220715-2.0.0'
}

tasks.named('test') {
    useJUnitPlatform()
}
```

&nbsp;

&nbsp;


#### CalendarQuickstart.java

&nbsp;

```java
@SpringBootApplication
public class CalendarQuickstart {

  private static final String APPLICATION_NAME = "Google Calendar API Java Quickstart";

  private static final JsonFactory JSON_FACTORY = GsonFactory.getDefaultInstance();

  private static final String TOKENS_DIRECTORY_PATH = "tokens"; //í† í° ì €ì¥ ê²½ë¡œ

  private static final List<String> SCOPES =
      Collections.singletonList(CalendarScopes.CALENDAR_READONLY);
  private static final String CREDENTIALS_FILE_PATH = "/credentials.json";

  private static Credential getCredentials(final NetHttpTransport HTTP_TRANSPORT)
      throws IOException {//ì¸ì¦ì— í•„ìš”í•œ ê°ì²´ ìƒì„±,ë°˜í™˜

    InputStream in = CalendarQuickstart.class.getResourceAsStream(CREDENTIALS_FILE_PATH);
    if (in == null) {
      throw new FileNotFoundException("Resource not found: " + CREDENTIALS_FILE_PATH);
    }
    GoogleClientSecrets clientSecrets =
        GoogleClientSecrets.load(JSON_FACTORY, new InputStreamReader(in));


    GoogleAuthorizationCodeFlow flow = new GoogleAuthorizationCodeFlow.Builder( // ì¸ì¦ íë¦„ ë§Œë“¤ê¸°
        HTTP_TRANSPORT, JSON_FACTORY, clientSecrets, SCOPES)
        .setDataStoreFactory(new FileDataStoreFactory(new java.io.File(TOKENS_DIRECTORY_PATH)))
        .setAccessType("offline")
        .build();
    LocalServerReceiver receiver = new LocalServerReceiver.Builder().setPort(8888).build();
    Credential credential = new AuthorizationCodeInstalledApp(flow, receiver).authorize("user"); //ì‚¬ìš©ì ì¸ì¦,í† í° ì €ì¥
    return credential;
  }

  public static void main(String... args) throws IOException, GeneralSecurityException {
    final NetHttpTransport HTTP_TRANSPORT = GoogleNetHttpTransport.newTrustedTransport();
    Calendar service =
        new Calendar.Builder(HTTP_TRANSPORT, JSON_FACTORY, getCredentials(HTTP_TRANSPORT))
            .setApplicationName(APPLICATION_NAME)
            .build();

    DateTime now = new DateTime(System.currentTimeMillis());
    Events events = service.events().list("primary")
        .setMaxResults(10)
        .setTimeMin(now)
        .setOrderBy("startTime")
        .setSingleEvents(true)
        .execute();
    List<Event> items = events.getItems(); // ê°€ì ¸ì˜¨ ì´ë²¤íŠ¸ ì €ì¥
    if (items.isEmpty()) {
      System.out.println("No upcoming events found.");
    } else {
      System.out.println("Upcoming events");
      for (Event event : items) {
        DateTime start = event.getStart().getDateTime();
        if (start == null) {
          start = event.getStart().getDate();
        }
        System.out.printf("%s (%s)\n", event.getSummary(), start); //ì´ë²¤íŠ¸ ìš”ì•½ê³¼ ì‹œì‘ì‹œê°„ ì¶œë ¥

      }
    }
    SpringApplication.run(CalendarQuickstart.class, args);
  }
}
```

&nbsp;

&nbsp;


ğŸ“Œ scopes

&nbsp;

```java
private static final List<String> SCOPES =
      Collections.singletonList(CalendarScopes.CALENDAR_READONLY);
```

&nbsp;


ìš”ì²­í•˜ëŠ” ì•¡ì„¸ìŠ¤ ë²”ìœ„ë¡œ ì—¬ê¸°ì„œëŠ” ìº˜ë¦°ë”ì— ëŒ€í•œ ì½ê¸° ì „ìš© ì•¡ì„¸ìŠ¤ë¥¼ ìš”ì²­

&nbsp;

&nbsp;


ğŸ“Œ ì´ë²¤íŠ¸ ê°€ì ¸ì˜¤ê¸°

&nbsp;


```java
Events events = service.events().list("primary")
        .setMaxResults(10)
        .setTimeMin(now)
        .setOrderBy("startTime")
        .setSingleEvents(true)
        .execute();
```

&nbsp;

> `setMaxResults(n)` : ìµœëŒ€ nê°œì˜ ì´ë²¤íŠ¸ ê°€ì ¸ì˜¤ê¸°

&nbsp;


> `setTimeMin(datetime)` : datetime ì´í›„ì˜ ì´ë²¤íŠ¸ë§Œ ê°€ì ¸ì˜¤ê¸°

&nbsp;


> `setOrderBy("startTime")` : ì´ë²¤íŠ¸ë¥¼ ì‹œì‘ ì‹œê°„ ìˆœìœ¼ë¡œ ì •ë ¬

&nbsp;


> `setSingleEvents(true)` : ë°˜ë³µë˜ëŠ” ì´ë²¤íŠ¸ë¥¼ ê°œë³„ ì´ë²¤íŠ¸ë¡œ í‘œì‹œ

&nbsp;


> `.excute()` : ìœ„ì˜ ì„¤ì •ì— ë”°ë¼ ì´ë²¤íŠ¸ ê°€ì ¸ì˜¤ê¸°

&nbsp;

&nbsp;

## ğŸª„ ì´ë²¤íŠ¸ ìƒì„±

&nbsp;


ìº˜ë¦°ë” ì¼ì •ì„ ë§Œë“¤ê³  ì‚¬ìš©ìì˜ ìº˜ë¦°ë”ì— ì¶”ê°€í•˜ëŠ” ë°©ë²•

&nbsp;

&nbsp;

#### ì¼ì • ì¶”ê°€

&nbsp;


ğŸ“Œ scopes

&nbsp;


```java
private static final List<String> SCOPES =
      Collections.singletonList(CalendarScopes.CALENDAR);
```

&nbsp;


OAuth ë²”ìœ„ë¥¼ ì‚¬ìš©ìì˜ ìº˜ë¦°ë”ì— ëŒ€í•œ ìˆ˜ì • ì•¡ì„¸ìŠ¤ ê¶Œí•œì„ ë¶€ì—¬í•˜ê²Œ ë³€ê²½

&nbsp;

&nbsp;

âš ï¸ 403 PERMISSION_DENIED

&nbsp;


```
"code": 403,
  "details": [
    {
      "@type": "type.googleapis.com/google.rpc.ErrorInfo",
      "reason": "ACCESS_TOKEN_SCOPE_INSUFFICIENT"
    }
  ],
  "errors": [
    {
      "domain": "global",
      "message": "Insufficient Permission",
      "reason": "insufficientPermissions"
    }
  ],
  "message": "Request had insufficient authentication scopes.",
  "status": "PERMISSION_DENIED"
```

&nbsp;


ê¶Œí•œì´ ì œëŒ€ë¡œ ë³€ê²½ë˜ì§€ ì•Šì•˜ëŠ”ë° ì´ëŠ” ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ì•¡ì„¸ìŠ¤ í† í°ì— ì˜í•œ ë¬¸ì œ

&nbsp;

&nbsp;


ğŸ“Œ í† í° í´ë” ì‚­ì œ

&nbsp;


ìœ„ì— ì§€ì •í•œ í† í° ì €ì¥ ê²½ë¡œ "tokens" í´ë” ì‚­ì œí•˜ê³  ë‹¤ì‹œ ì‹¤í–‰í•˜ë©´ ë³€ê²½ëœ ê¶Œí•œì„ í¬í•¨í•´ ìƒˆë¡œìš´ ì•¡ì„¸ìŠ¤ í† í° ë°œê¸‰

&nbsp;

&nbsp;


ğŸ“Œ ê²°ê³¼

&nbsp;


<img width="488" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-07 á„‹á…©á„’á…® 12 02 09" src="https://github.com/googleworkspace/java-samples/assets/53010592/882102d8-aa25-4b6a-9759-62fe39407337">

&nbsp;

&nbsp;


ğŸ“Œ main()

&nbsp;



```java

public static void main(String... args) throws IOException, GeneralSecurityException {
    // . . .

    Event event = new Event()
        .setSummary("Google I/O 2023")
        .setLocation("800 Howard St., San Francisco, CA 94103")
        .setDescription("A chance to hear more about Google's developer products.");

    DateTime startDateTime = new DateTime("2023-08-07T09:00:00-07:00"); //ì‹œì‘ì‹œê°„
    EventDateTime start = new EventDateTime()
        .setDateTime(startDateTime)
        .setTimeZone("America/Los_Angeles");
    event.setStart(start);

    DateTime endDateTime = new DateTime("2023-08-07T17:00:00-07:00"); //ì¢…ë£Œì‹œê°„
    EventDateTime end = new EventDateTime()
        .setDateTime(endDateTime)
        .setTimeZone("America/Los_Angeles");
    event.setEnd(end);

    String[] recurrence = new String[] {"RRULE:FREQ=DAILY;COUNT=2"}; //ì´ë²¤íŠ¸ ë°˜ë³µ
    event.setRecurrence(Arrays.asList(recurrence));

    EventAttendee[] attendees = new EventAttendee[] { // ì°¸ì„ì ì¶”ê°€
        new EventAttendee().setEmail("lpage@example.com"),
        new EventAttendee().setEmail("sbrin@example.com"),
    };
    event.setAttendees(Arrays.asList(attendees));

    EventReminder[] reminderOverrides = new EventReminder[] { // ì•Œë¦¼ ì„¤ì •
        new EventReminder().setMethod("email").setMinutes(24 * 60), //24ì‹œê°„ ì „
        new EventReminder().setMethod("popup").setMinutes(10), //10ë¶„ ì „
    };
    Event.Reminders reminders = new Event.Reminders()
        .setUseDefault(false)
        .setOverrides(Arrays.asList(reminderOverrides));
    event.setReminders(reminders);

    String calendarId = "primary"; //ì´ë²¤íŠ¸ë¥¼ ì‚¬ìš©ìì˜ ê¸°ë³¸ ìº˜ë¦°ë”ì— ì¶”ê°€
    event = service.events().insert(calendarId, event).execute();
    System.out.printf("Event created: %s\n", event.getHtmlLink());
}
```

&nbsp;


> `DateTime("YYYY-MM-DDTHH:MM:SS-ì‹œê°„ëŒ€")`: ë‚ ì§œ+T(ë‚ ì§œì™€ ì‹œê°„ ì‚¬ì´ êµ¬ë¶„í•˜ëŠ” ë¬¸ì)+ì‹œê°„+ì‹œê°„ëŒ€

&nbsp;


> `String[] recurrence = new String[] {"RRULE:FREQ=DAILY;COUNT=2"}` : ì´ë²¤íŠ¸ì˜ ë°˜ë³µ ì„¤ì •í•˜ëŠ” ê²ƒìœ¼ë¡œ ì¼ì¼(DAILY) ì´ 2ë²ˆ(COUNT) ë°˜ë³µ

&nbsp;


> `calendarId` : ìº˜ë¦°ë”ë¥¼ ì‹ë³„í•˜ëŠ”ë° ì‚¬ìš©ë˜ëŠ” ê³ ìœ í•œ ì‹ë³„ì

&nbsp;


> "primary"ëŠ” ì‚¬ìš©ìì˜ ê¸°ë³¸ ìº˜ë¦°ë”ì´ê³  ê° ìº˜ë¦°ë”ëŠ” ê³ ìœ í•œ calendarIdë¥¼ ê°–ê³  ìˆìŒ

&nbsp;

&nbsp;

ğŸ“Œ calendarId ì°¾ê¸°

&nbsp;


```java
CalendarList calendarList = service.calendarList().list().execute();
for (CalendarListEntry calendarListEntry : calendarList.getItems()) {
    System.out.println("Calendar ID: " + calendarListEntry.getId());
}
```

&nbsp;

&nbsp;

ğŸ“Œ ê²°ê³¼

&nbsp;


<img width="1858" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-07 á„‹á…©á„’á…® 2 28 39" src="https://github.com/googleworkspace/java-samples/assets/53010592/b8fc6ea9-6c0d-42ff-97a7-1125fc58e0de">

&nbsp;

&nbsp;

#### Drive ì²¨ë¶€íŒŒì¼ ì¶”ê°€

&nbsp;


ğŸ“Œ dependency ì¶”ê°€

&nbsp;


```gradle
implementation 'com.google.apis:google-api-services-drive:v3-rev20220815-2.0.0'
```

&nbsp;

&nbsp;


ğŸ“Œ ì—°ê²° ì¶”ê°€

&nbsp;


```java
public static void addAttachment(Calendar calendarService, Drive driveService, String calendarId,
                                    String eventId, String fileUrl)throws IOException {
    String fileId = extractFileIdFromUrl(fileUrl);
    File file = driveService.files().get(fileId).execute();
    Event event = calendarService.events().get(calendarId, eventId).execute();

    List<EventAttachment> attachments = event.getAttachments();
    if (attachments == null) {
    attachments = new ArrayList<EventAttachment>();
    }
    attachments.add(new EventAttachment()
    .setFileUrl("https://drive.google.com/file/d/" + fileId + "/view?usp=drive_link")
    .setMimeType(file.getMimeType())
    .setTitle(file.getName()));

    Event changes = new Event()
    .setAttachments(attachments);
    calendarService.events().patch(calendarId, eventId, changes)
    .setSupportsAttachments(true)
    .execute();
                                    }
public static void main(String... args) throws IOException, GeneralSecurityException {
    // . . .

    String fileUrl = "ì¶”ê°€í•˜ê³  ì‹¶ì€ ë“œë¼ì´ë¸Œ íŒŒì¼ URL"; 
    addAttachment(calendarService, driveService, calendarId, event.getId(), fileUrl);
}
```

êµ¬ê¸€ë“œë¼ì´ë¸Œ íŒŒì¼ url("https://drive.google.com/file/d/" + fileId + "/view?usp=drive_link")ì—ì„œ fileIdê°€ í•„ìš”í•´ extractFileIdFromUrl(fileUrl)ë¡œ ë¶„ë¦¬

&nbsp;

&nbsp;


ğŸ“ŒfileId ì¶”ì¶œ

&nbsp;


```java
private static String extractFileIdFromUrl(String url) {
    String fileId = null;
    try {
        URL fileUrl = new URL(url);
        String path = fileUrl.getPath();
        Pattern pattern = Pattern.compile("file/d/(.*?)/");
        Matcher matcher = pattern.matcher(path);
        if (matcher.find()) {
            fileId = matcher.group(1);
        }
    } catch (MalformedURLException e) {
    e.printStackTrace();
    }
    return fileId;
}
```

&nbsp;

&nbsp;

ğŸ“Œ ê²°ê³¼

&nbsp;


<img width="441" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-07 á„‹á…©á„’á…® 3 25 08" src="https://github.com/googleworkspace/java-samples/assets/53010592/aa75a2ba-6b37-44a8-9216-307799c96bcf">

&nbsp;

&nbsp;

#### í™”ìƒíšŒì˜ ì¶”ê°€

&nbsp;


ğŸ“Œ main()

```java
public static void main(String... args) throws IOException, GeneralSecurityException {
    // . . .
    ConferenceSolutionKey conferenceSKey = new ConferenceSolutionKey();
    conferenceSKey.setType("hangoutsMeet"); //GoogleMeet 
    CreateConferenceRequest createConferenceReq = new CreateConferenceRequest(); //íšŒì˜ ìƒì„±
    createConferenceReq.setRequestId(UUID.randomUUID().toString()); 
    createConferenceReq.setConferenceSolutionKey(conferenceSKey);
    ConferenceData conferenceData = new ConferenceData();
    conferenceData.setCreateRequest(createConferenceReq);
    event.setConferenceData(conferenceData);

    //event = calendarService.events().insert(calendarId, event).execute();
    event = calendarService.events().insert(calendarId, event).setConferenceDataVersion(1).execute(); //íšŒì˜ ìƒì„±í•˜ê³  ì´ë²¤íŠ¸ì— ì¶”ê°€
}
```

&nbsp;

>`.setConferenceDataVersion(1)` : Google Calendar APIì— ì´ë²¤íŠ¸ê°€ íšŒì˜ ë°ì´í„°ë¥¼ í¬í•¨í•˜ê³  ìˆìŒì„ ì•Œë¦¼
ì´ë¡œ ì¸í•´ APIëŠ” íšŒì˜ë¥¼ ìƒì„±í•˜ê³ , íšŒì˜ ì •ë³´ë¥¼ ì´ë²¤íŠ¸ì— ì¶”ê°€í•˜ë©°, ì´ë²¤íŠ¸ ì°¸ê°€ìì—ê²Œ íšŒì˜ì— ëŒ€í•œ ì •ë³´ë¥¼ ì œê³µ

&nbsp;

&nbsp;

ğŸ“Œ ê²°ê³¼

&nbsp;


<img width="432" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-07 á„‹á…©á„’á…® 3 34 30" src="https://github.com/googleworkspace/java-samples/assets/53010592/97c33076-1367-425d-9418-7f328093537e">

&nbsp;

&nbsp;


---
ì¶œì²˜:[GoogleWorkspace](https://developers.google.com/calendar/api/guides/overview?hl=ko)